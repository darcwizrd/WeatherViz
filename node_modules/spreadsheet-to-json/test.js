import { extractSheets } from './src';
import fs from 'fs';

var spreadsheetKey = '1BoadDkJeecx5Jzr2SnfLWsIcl2xxnwERSVP5j-HFzt4'
var sheetsToExtract = ['Species'];
var credentials =  {
  "private_key_id": "088a56cf8cb80268706137bcba576d639fc6e337",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC1nkira5mX0ijo\nSMz0rCgEOkVFTif0VBe+n6Qrg1SIUs8+Xx97vkEB18xQ04uD0C8d5Wgx0NGHKciD\nho5vascbvpyq/DWxJGxy/YHjTkpGEyHWPV/+zXS/xjxUoVuCLpg7GAqJLCO4ZuLp\nEJtA4Ts5aaVjUcOj11d/LcXGJf/sNNLnvmZZmJyyDowWwrsIdUDwR067gkUSRtsd\nvd+UXFqWtfK03gpgwKwxhv8YReNR9CJvMTMJ3ehrrwa0V7jYO4gq36L3F2ejfLY8\nWqIlrwctENgzYdxJhvDR4Js6hH0UCi9uEK/cmebwKx0nYWBshVcunUfcE2JdAAV+\nXTRBxEsbAgMBAAECggEAB7+VAhs5Fk0VCbPxao7dtjB2PBq1gasEyFEvQ9v6g0Zl\nKRgN082uIFIAmYIs9ZawK+pZo6ZxCf8yWsom0YIQtJJRRMo10DTpm45NOFFiwdKX\nIvjDW6+QR45BjKrFqKwsOnkwGeIUNA3PqHnY5c+2IyDquW4HlrndNcPSKD3+ySj1\nUkNVGGAaBwCE4pNz+SIy+k1MS4ZOYf8eQIzCJMm/k8AWvN/52ZrlbKydDRk7hS3y\nfLGluJE20wR547svB6CZr5hL1SM3pJT03P1v4RaXZPZnr4ks3k8KVj3o5G3lC+x1\nki653ZJVSbu9HI/NwWboLkSnbA0kX+iGOzk2ytDLgQKBgQDpBwUgW1/yI6whyX40\nMA1czRXIf14Dqrb8WRkANSt5sG1jIvCcTxdxVyHStUvnhyjW1k8AHaemtANroS+t\ngm7rHIyoPOOh+s5UkTtmercsKkh7A/OLjhCbofaeMAmIXkiVaTAYHvptDy3FY593\nNKLvkbjZb7dkwugwbmrxbJcSEQKBgQDHhdZD0oeNtJsxQGsdULL1q8ZYYUJ6goax\nBNOBG3JmziRxFYZEihW5nFCBkC5MgoLPkS4nu5mQEjHujtivJvRpw8vj46yPG5/3\nSAb7WFaqtVeA5hrGtT6bBWhrbjU8U3d8HKfST7vH4aDKXpeU3499esF76NQT2KMs\nP/lmuKXeawKBgGqgj7Pym8CMmiMLs/flVPf1z9Xikf5Ti0+E5W+25KHWHPeT8U1U\n04FFQXDNDGJw8jr77UI8T450KGyDYPGgEWj7s1D4K6DexrLjka6e0FohLvE7KaHd\n67OLNPHFQVdo7QWREDS5WBW3MFZ18230Y+oDX/X+rIgqt1wR6lV2PtpBAoGBAKok\nGRjw2KMgVg7jzfPLszAH8TXAin4J/G3LncjE7QN52l2Ma1jbH7eN8qDpoHGiAYab\nWO6M7WCMA4RYz7Jc16OxUZbduXK3reuiwkFnjVA5H4tNrZuxRtfO/sJN0pvE2Wk+\nzmVrlMfYQdMQYtaS5butCH1viBn8bPj4/OZ5owhNAoGAUkV9X/GjwTJZ4hM/Uexk\nmo0nnr5x89t91pfDNYAwHAXCHTsgnF1hukMpzwS3dbOmQlx6lZLMz6OAgWLXGPha\ntiPo+qjpv6syIQ3kL96Clk+guzyLZdGrV3M2ZHzR6FAywVRt6TFEr7LF/p0axBXY\nsZMg0XLGQcIVdDCJNA855xU\u003d\n-----END PRIVATE KEY-----\n",
  "client_email": "956361635139-o78hjbgpkphe1hnj920l33gmik86pkso@developer.gserviceaccount.com",
  "client_id": "956361635139-o78hjbgpkphe1hnj920l33gmik86pkso.apps.googleusercontent.com",
  "type": "service_account"
}

extractSheets({
    spreadsheetKey,
    sheetsToExtract,
    credentials
}, function(err, data) {
    data.Species.forEach(specie => {
      if (specie.id === 'cheetah') {
        console.log(specie);
      }
    });
    sheetsToExtract.map(sheetName => {
        console.log(`✔ ${data[sheetName].length} ${sheetName}`);
    })
    console.log('');
    const outputFile = './data.json';
    fs.writeFile(outputFile, JSON.stringify(data), function() {
        console.log(`✔ exported to ${outputFile}`);
    });
});
